Title: QuickBooks dashboard to find patterns in finance, sales, and forecasts - Blackcoffer Insights

HomeOur Success StoriesQuickBooks dashboard to find patterns in finance, sales, and forecastsOur Success StoriesITLifestyle, eCommerce & Online Market PlaceQuickBooks dashboard to find patterns in finance, sales, and forecastsByAjay Bidyarthy-September 18, 20213642Client BackgroundClient:A leading marketing firm in the USAIndustry Type:MarketingServices:e-commerce, retail business, marketingOrganization Size:100+Project ObjectiveBuild a fully Integrated BI Platform in PowerBI using native connectors and APIs(QuickBooks and Airtable) to pull real time data from many sources.Project DescriptionFor building a fully integrated BI Platform , the data has to come from the following sources to feed it to PowerBI –·QuickBooks :An accounting software that accepts real-time business payments ,  manage and pay bills, manage organisation’s deposits/expenses , customers ,and payroll functions. The following data/tables has to be fetched from Quickbooks –o   Customero   Invoiceso   Product & Serviceso   Paymentso   Expenseso   Depositso   Accountso   Vendorso   Departmentso   Classes·Airtable :An online database hybrid platform for creating and sharing relational databases with friendly user interfaces. The following databases with multiple data table has to be fetched from Airtable –o   Marketing Data Analytics Base (Google Ads , Facebook Ads)o   Payroll Tracking (Payroll , Hours Log)This Quickbook and Airtable real time data has to go to the powerBI service (https://app.powerbi.com). Then create useful visualisation and dashboards based on plan and feedback from the executive team. All visuals in dashboards should automatically update without any intervention to make it fully integrated.Our SolutionCollecting data tables from data sources :Data Pipeline(QuickBooks to Airtable)– We have built a Data Pipeline in Python that uses quickbooks API(https://pypi.org/project/python-quickbooks/) to get raw data tables from QuickBooks and uses Airtable API (https://api.airtable.com/v0/base_key/Table_name?api_key=YOUR_API_KEY) to write/update data in Airtable. It fetches all the below raw tables after making requests to QuickBooks API –Customers , Invoices , Expenses , DepositsAccounts , Departments , Vendors etc.After getting these raw data tables , pipeline converts it into DataFrame , then writes/updates it into Airtable.The Pipeline is deployed in a server that runs every night , it fetches the data from QuickBooks API and writes/updates to Airtable.Airtable to PowerBI– As there is no connector available to sync data from Airtable to PowerBI. We have used pagination using DAX queries to get data from Web Sources i.e. Airtable API. Pagination fetches the data page by page  using a source and offset technique set by the Airtable API developers. It successfully fetches all the below bases from Airtable API –Marketing Data Analytics Data (Google Ads , Facebook Ads)Payroll Data (Payroll , Hours Log)Scheduled Refresh :To refresh visualization/dashboard (If incoming data from Airtable API has updated) , set refresh time in powerBI service.Preprocessing of  Data –We have used DAX queries to prepare and process the raw data coming from Airtable like –Split data , typecast dataFilter data (fill missing values , delete irrelevant rows etc.)Create visualizations/Dashboards– We have used following techniques to create visualizations –Used M code queries to extract useful/desired dataUsed measure to perform calculations on dataUse a calculated table to create a relationship between two tables.Used data joining (Union , Intersection) to get desired dataProject DeliverablesBelow are the services that we provided to client after completion of this project –Deployed Data Pipeline:  A Data Pipeline connecting QuickBooks to Airtable to sync in the following data tables –CustomersInvoicesProduct & ServicesExpenseDepositsPaymentsAccountsVendorsDepartmentsClassesQuickBooks Data Dashboard: It contains following visualizations –KPIs –Total RevenueTotal SpendTotal ProfitProfit MarginNo. of CustomerLine Charts –Revenue/Expense over daysBar Charts –Revenue & Expenses by BusinessesProfit/loss by BusinessesRevenue & Expense by ClassProfit/loss by ClassPie ChartExpenses by CategoryPaid/Unpaid InvoicesTables –[Class , Business , Revenue , Spend , Profit , Profit Margin)[Customer , Balance , Due(in days)][Customer , Balance , OverDue][Account , QuickBooks Balance]Filters/Slicer –Transaction DateBusinessClassMarketing Analytics (Facebook Ads) Dashboard–KPIs –All ImpressionsTotal ReachTotal Link ClicksAverage CPMAmount Spent on AdsTotal BudgetBudget LeftLine Charts –Avg. Frequency Over DaysAvg. CPC over daysImpressions , Reach and Page Engagement over daysLink Clicks by day and Account NameResults , Cost per Results over daysAd set Budget and Amount Spent Over daysBar Charts –Ad set Budget and Amount Spent by Account NameGauge –Daily Avg. LinksCount of Ongoing CampaignsTables –Top Compeigns [Account name , Compeign name , Link Clicks , Impressions , Reach , Avg. Frequency , Social Impressions]Filters/Slicer –Account nameDate RangeMarketing Analytics (Google Ads) Dashboard–KPIs –Total ImpressionsTotal ClicksTotal ConversionsTotal CostDaily Avg. CostDaily Avg. CTRDaily Avg. Conversion RateDaily Avg. Cost per ConversionLine Charts –Clicks and Conversions over daysAvg. CPC over days by Day and Google Ad AccountClicks per Impressions by Day and Google Ad AccountImpressions by Day and Google Ad AccountCost by Day and Google Ad AccountClicks by Day and Google Ad AccountGauge –Avg. Daily new ConversionsPie Chart –Count of Google Ad AccountsTables –Top Ads [Ad name , Ad Group , Conversions][Google Ad Account , Impressions , Clicks , Conversions]Filters/Slicer –Date RangeGoogle Ad Account NamePayroll Dashboard–KPIs –$ Total Payroll$ Avg. RateCount of InvoiceTotal Payroll Time (in hrs.)Avg. TurnArroundTime (in Days)Total HoursLine Charts –Avg. Rate over DaysAvg. daily Pay AmountBar Chart –Payroll time by Employee$ Payroll by EmployeeHours by EntityTotal hours by EmployeePie Chart –Paid/Unpaid InvoicesTables –Payroll [Employee , Count of Invoice , Total Due , Paid Before/After Due Date]Filters/Slicer –Date RangeEmployee nameEntity nameTools usedPowerBILanguage/techniques usedPythonPaginationSkills usedProgramming in PythonData Structure & AlgorithmAPI Integration (QuickBooks , Airtable)File HandlingPowerBI(with DAX , M code queries)Data AnalyticsWhat are the technical Challenges Faced during Project Execution?QuickBooks Refresh Token Expired Issue: As stated in QuickBooks Developer Guide , we need refresh token to access QuickBooks API and it expires after 101 days. But that is not the case , it usually expires within 2 to 4 days depending on how frequently we access the API. In that case our deployed Pipeline does not work if the token expired.Getting data from Airtable to PowerBI: As PowerBI has no Airtable data source connector to fetch data from Airtable , we did use Web Source connector using Airtable data web links. It only fetches the 1st page that is 100 rows from Airtable base because Airtable API gives only 100 rows/request.Dynamic Data Source Refresh Issue:  As the URL of Airtable bases data changes based on the size of data. PowerBI recognizes it as Dynamic Data Source , hence it gives the error “Dynamic Data Source Refresh Error” in PowerBI Service.How the Technical Challenges were SolvedQuickBooks Refresh Token Expired Issue:  As the token may expire anytime after 2 days , so to resolve this we have added a gui element in Pipeline so that if token expires a pop up will appear asking for a new refresh token , until the consumer enters a valid new token from their QuickBook developer account , a pop up will keep coming and pipeline will be paused. Once the user enters a new token , the pipeline will continue working.Getting data from Airtable to PowerBI: To resolve this issue , we have used Pagination technique as below –First request Airtable API with proper URL , api_key and blank_offset (data_url?API_KEY=api_key?OFFSET=blank_offset)This request returns first 100 rows of data and a new offset valueNow replace the previous offset value with a new offset value in the URL , and again make an API request.This request will return the next 100 rows of data and a new offset.Do this until you get a null offset (null offset means , all data has been fetched)This is how we get all the data of any size from Airtable bases.Dynamic Data Source Refresh Issue: The above mentioned Pagination technique converts dynamic URLs of Airtable bases data into static URLs. So PowerBI gives no error as it has been converted to a static data source. Now the client can refresh the dashboard manually by clicking the refresh button or can set automatic refresh daily at some given time.Project SnapshotsProject Videohttps://www.youtube.com/watch?v=iemcyRtWPNU&ab_channel=BlackcofferPrevious articleMarketing, sales, and financial data business dashboard (Wink Report)Next articleGoogle Data Studio Pipeline with GCP/MySQLAjay BidyarthyRELATED ARTICLESMORE FROM AUTHORAI and ML-Based YouTube Analytics and Content Creation Tool for Optimizing Subscriber Engagement and Content StrategyEnhancing Front-End Features and Functionality for Improved User Experience and Dashboard Accuracy in Partner Hospital ApplicationROAS Dashboard for Campaign-Wise Google Ads Budget Tracking Using Google Ads APMOST POPULAR INSIGHTSGoogle Local Service Ads (LSA) Data WarehouseAugust 30, 2021Auctions Data Automation, Collection, ETL, and ManagementMay 23, 2021Impact of COVID-19 pandemic on sports events around the world.June 23, 2020Effective Management of Social Media Data Extraction: Strategies for Authentication, Security,...March 17, 2024Load moreRECOMMENDED INSIGHTSDeploy MERN to google app engine, google cloud platformLessons from the past: Some key learnings relevant to the coronavirus...What do you think is the lesson (or lessons) to be...Travel and Tourism Outlook